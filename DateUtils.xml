<?xml version="1.0" encoding="utf-8"?>
<!-- This file along with its dll needs to be installed to ...InstallDir...\RuntimeData\FormulaAddIn to run. -->
<!-- Is Culture Specific as Uses names opf weekdays -->
<FormulaAddIn>
  <Function>
    <Name>YEAR</Name>
    <NumParams variable="false">1</NumParams>
    <Category>Date</Category>
    <InsertText>YEAR(Date)</InsertText>
    <Description>Get year of Date</Description>
    <Formula>ToNumber(DateTimeFormat(P1, "%Y"))</Formula>
  </Function>
  <Function>
    <Name>MONTH</Name>
    <NumParams variable="false">1</NumParams>
    <Category>Date</Category>
    <InsertText>MONTH(Date)</InsertText>
    <Description>Get month (1-12) of Date</Description>
    <Formula>ToNumber(DateTimeFormat(P1, "%m"))</Formula>
  </Function>
  <Function>
    <Name>DAY</Name>
    <NumParams variable="false">1</NumParams>
    <Category>Date</Category>
    <InsertText>Day(Date)</InsertText>
    <Description>Get day of month (1-31) of Date</Description>
    <Formula>ToNumber(DateTimeFormat(P1, "%d"))</Formula>
  </Function>
  <Function>
    <Name>WEEKDAY</Name>
    <NumParams variable="false">1</NumParams>
    <Category>Date</Category>
    <InsertText>WEEKDAY(Date)</InsertText>
    <Description>Convert a date to day of week (0 Sundaty - 6 Saturday)</Description>
    <Formula>Switch(DateTimeFormat(P1,"%a"),NULL(),"Sun",0,"Mon",1,"Tue",2,"Wed",3,"Thu",4,"Fri",5,"Sat",6)</Formula>
  </Function>
  <Function>
    <Name>QUARTER</Name>
    <NumParams variable="false">1</NumParams>
    <Category>Date</Category>
    <InsertText>QUARTER(Date)</InsertText>
    <Description>Convert date to quarter</Description>
    <Formula>FLOOR((MONTH(P1)+2)/3)</Formula>
  </Function>
  <Function>
    <Name>BUSINESSDAYS</Name>
    <NumParams variable="false">2</NumParams>
    <Category>Date</Category>
    <InsertText>BUSINESSDAYS(StartDate, EndDate)</InsertText>
    <Description>Number of business days (M-F) between two dates.</Description>
    <Formula>IIF(P1>P2,NULL(), 1 + ((DateTimeDiff(P2,P1,"days")*5 - (WEEKDAY(P1)-WEEKDAY(P2))*2) / 7) +  IIF(WEEKDAY(P2)==6,-1,0) +  IIF(WEEKDAY(P1)==0,-1,0))</Formula>
  </Function>
  <Function>
    <Name>MAKEDATE</Name>
    <NumParams variable="false">3</NumParams>
    <Category>Date</Category>
    <InsertText>MAKEDATE(Year, Month, Day)</InsertText>
    <Description>Create a Date</Description>
    <Formula>TOSTRING(P1, 0) + "-" + RIGHT("00" + TOSTRING(P2, 0), 2) + "-" + RIGHT("00" + TOSTRING(P3, 0), 2)</Formula>
  </Function>
  <Function>
    <Name>WEEKSTART</Name>
    <NumParams variable="false">1</NumParams>
    <Category>Date</Category>
    <InsertText>WEEKSTART(Date)</InsertText>
    <Description>Move to First day of the week (Sunday)</Description>
    <Formula>DateTimeAdd(P1, -WEEKDAY(P1), "days")</Formula>
  </Function>
  <Function>
    <Name>WEEKEND</Name>
    <NumParams variable="false">1</NumParams>
    <Category>Date</Category>
    <InsertText>WEEKDAY(Date)</InsertText>
    <Description>Move to Last day of the week (Saturday)</Description>
    <Formula>DateTimeAdd(P1, 6 - WEEKDAY(P1), "days")</Formula>
  </Function>
  <Function>
    <Name>ISLEAPYEAR</Name>
    <NumParams variable="false">1</NumParams>
    <Category>Date</Category>
    <InsertText>ISLEAPYEAR(Year)</InsertText>
    <Description>Is a year a leap year</Description>
    <Formula>(P1 % 4 == 0) AND (P1 % 100 != 0 OR P1 % 400 == 0)</Formula>
  </Function>
  <Function>
    <Name>ORDINALDAY</Name>
    <NumParams variable="false">1</NumParams>
    <Category>Date</Category>
    <InsertText>ORDINALDAY(Date)</InsertText>
    <Description>The position within the year</Description>
    <Formula>ToNumber(DateTimeFormat(P1, "%j"))</Formula>
  </Function>
  <Function>
    <Name>MONTHSTART</Name>
    <NumParams variable="false">1</NumParams>
    <Category>Date</Category>
    <InsertText>MONTHSTART(Date)</InsertText>
    <Description>Create the first day of the month</Description>
    <Formula>LEFT(P1,8) + "01"</Formula>
  </Function>
  <Function>
    <Name>MONTHEND</Name>
    <NumParams variable="false">1</NumParams>
    <Category>Date</Category>
    <InsertText>MONTHEND(Date)</InsertText>
    <Description>Create the last day of the month</Description>
    <Formula>DATETIMEADD(DATETIMEADD(LEFT(P1,8) + "01", 1, "Months"), -1, "Days")</Formula>
  </Function>
  <Function>
    <Name>YEARSTART</Name>
    <NumParams variable="false">1</NumParams>
    <Category>Date</Category>
    <InsertText>YEARSTART(Date)</InsertText>
    <Description>Create the first day of the year</Description>
    <Formula>LEFT(P1,5) + "01-01"</Formula>
  </Function>
  <Function>
    <Name>YEAREND</Name>
    <NumParams variable="false">1</NumParams>
    <Category>Date</Category>
    <InsertText>YEAREND(Date)</InsertText>
    <Description>Create the last day of the year</Description>
    <Formula>LEFT(P1,5) + "12-31"</Formula>
  </Function>
  <Function>
    <Name>QUARTERSTART</Name>
    <NumParams variable="false">1</NumParams>
    <Category>Date</Category>
    <InsertText>QUARTERSTART(Date)</InsertText>
    <Description>Create the first day of the quarter</Description>
    <Formula>LEFT(P1,5) + RIGHT("00" + TOSTRING(QUARTER(P1) * 3 - 2, 0), 2) + "-01"</Formula>
  </Function>
  <Function>
    <Name>QUARTEREND</Name>
    <NumParams variable="false">1</NumParams>
    <Category>Date</Category>
    <InsertText>QUARTEREND(Date)</InsertText>
    <Description>Create the last day of the quarter</Description>
    <Formula>MONTHEND(LEFT(P1,5) + RIGHT("00" + TOSTRING(QUARTER(P1) * 3, 0), 2) + "-01")</Formula>
  </Function>
</FormulaAddIn>
